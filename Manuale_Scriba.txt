================================================================================
SCRIBA - Advanced Robocopy Wrapper per Windows
Versione: 2.1.0, dicembre 2025.
================================================================================

DESCRIZIONE
-----------
Scriba è uno script Python (disponibile anche come eseguibile standalone) progettato 
per orchestrare backup incrementali e mirror tramite l'utility nativa Windows 'Robocopy'. 
Offre un'interfaccia CLI interattiva, gestione dei preset e statistiche native 
estratte direttamente dal motore di copia per la massima precisione.

CARATTERISTICHE TECNICHE (v2.1.0)
---------------------------------
- Motore: Robocopy ottimizzato con flag (/MIR /XJ /FFT /R:1 /W:1 /NP /NDL /BYTES).
- Dati: Preset salvati in JSON con backup automatico anti-corruzione (.bak).
- UI: Interfaccia CLI con dialoghi di sistema nativi (wxPython).
- Sicurezza: Machine ID check per prevenire esecuzioni su macchine errate.
- Feedback: Barra di avanzamento basata sul VOLUME DATI (Byte) per un ETA reale.
- Accessibilità: Refresh della barra ogni 3 secondi (ottimizzato per screen reader).
- Gestione Esclusioni: Supporto nativo per escludere cartelle specifiche dai preset.

INSTALLAZIONE ED ESECUZIONE
---------------------------
A. ESEGUIBILE (Consigliato per portabilità)
   1. Scaricare l'ultima release (Scriba.exe).
   2. Eseguire il file. I settings verranno creati nella stessa cartella.

B. SCRIPT PYTHON (Per sviluppo/modifica)
   Requisiti: Python 3.x, Windows 10/11.
   1. Installare la dipendenza GUI: pip install wxPython
   2. Lanciare lo script: python scriba.py

STRUTTURA DEL PRESET
--------------------
Ogni preset di backup è composto da:
- Titolo univoco.
- Periodicità (giorni di validità).
- Machine ID della macchina di creazione.
- Root Destinazione (es. H:\Backup).
- Lista di coppie Cartella Origine -> Nome Destinazione.
- Lista di cartelle da ESCLUDERE.

VOCI DI MENU
------------

1. ESEGUI BACKUP
   Lancia la procedura reale.
   - Fase 1: Inventario rapido (Byte/File previsti).
   - Fase 2: Esecuzione con monitoraggio costante dei dati trasferiti.
   - Report Finale: Statistiche dettagliate (Copiati, Saltati, Falliti).
   - Opzione spegnimento PC al termine.
   
2. ESEGUI SIMULAZIONE (Dry Run)
   Esegue Robocopy con flag /L (List only). Utile per vedere cosa verrebbe 
   modificato senza toccare i file.

3. VISUALIZZA PRESETS
   Dashboard con stato scadenze e ID Macchina.

4. AGGIUNGI PRESET
   Wizard guidato con selezione cartelle nativa e gestione esclusioni.

5. MODIFICA PRESET
   Permette di alterare dati, aggiungere/rimuovere origini o esclusioni, 
   o "Adottare" un preset su una nuova macchina (aggiorna Machine ID).

6. ELIMINA PRESET
   Rimuove la configurazione dal file JSON.

7. ESCI
   Chiude l'applicazione.

LOGGING
-------
I file di log (.txt) vengono salvati nella destinazione sotto \Logs.
Vengono sovrascritti a ogni sessione per risparmiare spazio. 
Al termine della copia, viene visualizzato il percorso dei log.

NOTE SUL MOTORE DI COPIA
------------------------
Scriba usa la modalità MIRROR (/MIR). 
I file presenti nella destinazione ma NON nell'origine verranno eliminati.
La barra di progresso e l'ETA si basano sui Byte trasferiti, garantendo 
fluidità anche con file di grandi dimensioni.
L'output è limitato a un aggiornamento ogni 3 secondi per favorire 
l'accessibilità con sintesi vocali.

--------------------------------------------------------------------------------
TUTORIAL: IL TUO PRIMO BACKUP
--------------------------------------------------------------------------------

1. CREAZIONE
   - Seleziona "4. Aggiungi Preset".
   - Nome: "Lavoro"; Periodicità: "1" (giorni).
   - Destinazione: Seleziona il tuo disco esterno (es. E:\Backups).
   - Origine: Seleziona la cartella "Documenti".
   - Aggiungine altre se vuoi, poi rispondi "n" per salvare.

2. VERIFICA (SIMULAZIONE)
   - Seleziona "2. Esegui SIMULAZIONE".
   - Scegli il preset "Lavoro".
   - Osserva il log a video e la barra di progresso (aggiornamento ogni 3s).
   - Al termine, controlla che Robocopy abbia listato i file corretti.

3. ESECUZIONE
   - Seleziona "1. Esegui Backup".
   - Conferma il riepilogo.
   - Attendi il completamento e leggi il rapporto finale.

--------------------------------------------------------------------------------
DISCLAIMER
Questo software esegue operazioni distruttive sulla destinazione (/MIR).
Sebbene testato accuratamente, l'autore non si assume responsabilità per 
perdite di dati. Usare sempre la modalità SIMULAZIONE prima di nuovi backup.
================================================================================